# Shinydashboard(å„€éŒ¶æ¿)æ‰‹å‹•æ·»åŠ æ•¸æ“šç¹ªè£½é¢¨èŠ±åœ–
> [color=#40f1ef][name=LHBé˜¿å¥½ä¼¯, 2021/06/13][:earth_africa:](https://www.facebook.com/LHB0222/)
###### tags: `R` `ggplot2` `å¯è¦–åŒ–`

[TOC]

![](https://i.imgur.com/KFdMCHb.png)

![](https://i.imgur.com/2D75VUT.png)

![](https://i.imgur.com/B7Mn1X5.png)

# ç¨‹å¼ç¢¼
```r=
#é¢¨èŠ±åœ–å„€éŒ¶æ¿
#https://gtgrthrst.shinyapps.io/Wind_Rose_pro/


#install.packages()
library("shiny")
#library("jsonlite")
library("rvest")
library("magrittr")
#library("lubridate")
library("ggplot2")
#library("shinydashboard")
library("DataEditR")
suppressPackageStartupMessages(library(jsonlite))
suppressPackageStartupMessages(library(lubridate))
suppressPackageStartupMessages(library(shinydashboard))
WRdata1 <- data.frame(WS = c(rep(1, times = 1, length.out = 10)),
                      WD = c(rep("E", times = 1, length.out = 10)))
WRdata2 <- data.frame(WS = c(rep(1, times = 1, length.out = 10)),
                      WD = c(seq(from = 1,to = 360,by = 36)))
WSbreak <- data.frame(breaks =c(0, 0.3, 1.6, 3.4, 5.5, 8.0,10.8, 13.9, 17.2, 20.8, 24.5, 28.5, 32.7, Inf),
                      labels = c("0~0.2","0.3~1.5", "1.6~3.3", "3.4~5.4", "5.5~7.9", "8.0~10.7", "10.8~13.8", "13.9~17.1", "17.2~20.7", "20.8~24.4","24.5~28.4", "28.5~32.6" , ">32.7","Inf"))
windD <- factor(c("N","NNE","NE","ENE","E","ESE","SE","SSE","S","SSW","SW","WSW","W","WNW","NW","NNW"))
windD2 <- factor(c("N","NNE","NE","ENE","E","ESE","SE","SSE","S","SSW","SW","WSW","W","WNW","NW","NNW","N"))

WRplot <- function(WRdata = WRdata1, plottitle = "", WSbreaksdata = WSbreak){
    #WRdata <- read_csv("C:/R/110Q2.csv")
    WRdata$Windspeed_N <- cut(as.numeric(WRdata$WS),
                              breaks =as.numeric(WSbreaksdata$breaks),
                              labels =force(WSbreaksdata$labels[-length(WSbreaksdata$labels)]),
                              right = F)
    
    windD <- factor(c("N","NNE","NE","ENE","E","ESE","SE","SSE","S","SSW","SW","WSW","W","WNW","NW","NNW"))
    WRdata$WD <- factor(WRdata$WD)
    
    p1 <- ggplot(data = na.omit(WRdata), aes(x = WD, fill = Windspeed_N))+
        geom_bar(aes(y = (..count..)/sum(..count..)*100 ), 
                 position = position_stack(reverse = TRUE)) +
        theme_bw() + scale_x_discrete(drop = FALSE,
                                      limits= windD) +
        scale_fill_discrete(guide = guide_legend(reverse=TRUE), name = "Wind Speed (m/s)")+
        coord_polar(start = -0.2) + 
        xlab("") + ggtitle(plottitle) + ylab("%") +
        theme(legend.text=element_text(family = "Times New Roman"))+
        theme(legend.title=element_text(family = "Times New Roman"))+
        theme(axis.title.y = element_text(family = "Times New Roman"))+
        theme(title=element_text(family = "DFKai-SB"))
    print(p1)
}
WRplot2 <- function(WRdata = WRdata1,plottitle = "", WSbreaksdata = WSbreak){
    #WRdata <- read_csv("C:/R/110Q2.csv")
    WRdata$Windspeed_N <- cut(as.numeric(WRdata$WS),
                              breaks =as.numeric(WSbreaksdata$breaks),
                              labels =force(WSbreaksdata$labels[-length(WSbreaksdata$labels)]),
                              right = F)
    
    windD <- factor(c("N","NNE","NE","ENE","E","ESE","SE","SSE","S","SSW","SW","WSW","W","WNW","NW","NNW"))
    WRdata$WD <- factor(WRdata$WD)
    
    p1 <- ggplot(data = na.omit(WRdata), aes(x = WD, fill = Windspeed_N))+
        geom_bar( position = position_stack(reverse = TRUE)) +
        theme_bw() + scale_x_discrete(drop = FALSE,
                                      limits= windD) +
        scale_fill_discrete(guide = guide_legend(reverse=TRUE), name = "Wind Speed (m/s)")+
        coord_polar(start = -0.2) + 
        xlab("") + ggtitle(plottitle) + ylab("n") +
        theme(legend.text=element_text(family = "Times New Roman"))+
        theme(legend.title=element_text(family = "Times New Roman"))+
        theme(axis.title.y = element_text(family = "Times New Roman"))+
        theme(title=element_text(family = "DFKai-SB"))
    print(p1)
}
WRplot3 <- function(WRdata = WRdata2,plottitle = "",WSbreaksdata = WSbreak){
    #WRdata <- read_csv("C:/R/110Q2.csv")
    WRdata$Windspeed_N <- cut(as.numeric(WRdata$WS),
                              breaks =as.numeric(WSbreaksdata$breaks),
                              labels =force(WSbreaksdata$labels[-length(WSbreaksdata$labels)]),
                              right = F)
    WRdata$WD_N <- cut(as.numeric(WRdata$WD),
                       breaks = c(0, 11.26, 33.76, 56.26, 78.76, 101.26, 127.76, 146.26, 168.76, 191.26, 213.76, 236.26, 258.76, 281.26, 303.76, 326.26, 348.75, 360),
                       windD2,
                       include.lowest = TRUE)
    
    p1 <- ggplot(data = na.omit(WRdata), aes(x = WD_N, fill = Windspeed_N))+
        geom_bar(aes(y = (..count..)/sum(..count..)*100 ), 
                 position = position_stack(reverse = TRUE)) +
        theme_bw() + scale_x_discrete(drop = FALSE,
                                      limits= windD) +
        scale_fill_discrete(guide = guide_legend(reverse=TRUE), name = "Wind Speed (m/s)")+
        coord_polar(start = -0.2) + 
        xlab("") + ggtitle(plottitle) + ylab("%") +
        theme(legend.text=element_text(family = "Times New Roman"))+
        theme(legend.title=element_text(family = "Times New Roman"))+
        theme(axis.title.y = element_text(family = "Times New Roman"))+
        theme(title=element_text(family = "DFKai-SB"))
    print(p1)
}
WRplot4 <- function(WRdata = WRdata2,plottitle = "",WSbreaksdata = WSbreak){
    #WRdata <- read_csv("C:/R/110Q2.csv")
    WRdata$Windspeed_N <- cut(as.numeric(WRdata$WS),
                              breaks =as.numeric(WSbreaksdata$breaks),
                              labels = force(WSbreaksdata$labels[-length(WSbreaksdata$labels)]),
                              right = F)
    WRdata$WD_N <- cut(as.numeric(WRdata$WD),
                       breaks = c(0, 11.26, 33.76, 56.26, 78.76, 101.26, 127.76, 146.26, 168.76, 191.26, 213.76, 236.26, 258.76, 281.26, 303.76, 326.26, 348.75, 360),
                       windD2,
                       include.lowest = TRUE)
    p1 <- ggplot(data = na.omit(WRdata), aes(x = WD_N, fill = Windspeed_N))+
        geom_bar( position = position_stack(reverse = TRUE)) +
        theme_bw() + scale_x_discrete(drop = FALSE,
                                      limits= windD) +
        scale_fill_discrete(guide = guide_legend(reverse=TRUE), name = "Wind Speed (m/s)")+
        coord_polar(start = -0.2) + 
        xlab("") + ggtitle(plottitle) + ylab("n") +
        theme(legend.text=element_text(family = "Times New Roman"))+
        theme(legend.title=element_text(family = "Times New Roman"))+
        theme(axis.title.y = element_text(family = "Times New Roman"))+
        theme(title=element_text(family = "DFKai-SB"))
    print(p1)
}
WindData <- function(station_number,start_date,end_date){
    url_start <- paste0("https://e-service.cwb.gov.tw/HistoryDataQuery/DayDataController.do?command=viewMain&station=",station_number,"&stname=%25E5%25A4%25A7%25E5%25AF%25AE&datepicker=")
    start_date <- ymd(start_date)  #èµ·å§‹æ™‚é–“
    end_date <- ymd(end_date)  #çµ‚æ­¢æ™‚é–“
    data1 <- data.frame()
    data2 <- data.frame()
    for(d in c(0:(end_date - start_date))){
        url <- paste0(url_start,as.character(start_date + d),"#")
        #æ™‚é–“è³‡æ–™
        time_H <- url %>% 
            read_html() %>%
            html_nodes(xpath='//*[(@id = "MyTable")]//td[(((count(preceding-sibling::*) + 1) = 1) and parent::*)]') %>% 
            html_text(trim	= T) %>% 
            as.numeric()
        #é¢¨é€Ÿè³‡æ–™
        Windspeed <- url %>%
            read_html() %>%
            html_nodes(xpath='//td[(((count(preceding-sibling::*) + 1) = 7) and parent::*)]') %>%
            html_text(trim	= T) %>% 
            gsub("X","-9999", .) %>% 
            as.numeric()
        #é¢¨å‘
        windDirection<- url %>%
            read_html() %>%
            html_nodes(xpath='//td[(((count(preceding-sibling::*) + 1) = 8) and parent::*)]') %>%
            html_text(trim	= T) %>% 
            gsub("X","-9999", .) %>% 
            as.numeric()
        data1 <- cbind(as.character(start_date + d), time_H, Windspeed,windDirection)  #åˆä½µè³‡æ–™
        data2 <- rbind(data2, data1)
    }
    windD <- factor(c("N","NNE","NE","ENE","E","ESE","SE","SSE","S","SSW","SW","WSW","W","WNW","NW","NNW","N"))
    data3 <- na.omit(data2)  #åˆªé™¤åŒ…å«NAå€¼çš„åˆ—
    data3$windDirection_N <- cut(as.numeric(data3$windDirection),
                                 breaks = c(0, 11.26, 33.76, 56.26, 78.76, 101.26, 127.76, 146.26, 168.76, 191.26, 213.76, 236.26, 258.76, 281.26, 303.76, 326.26, 348.75, 360),
                                 windD,
                                 include.lowest = TRUE)
    data3$Windspeed_N <- cut(as.numeric(data3$Windspeed),
                             breaks =c(0, 2.1, 4.1,  6.1, Inf),
                             labels = c("0~2", "2.1~4", "4.1~6", ">6.1"),
                             right = F)
    data3$Windspeed <- as.numeric(data3$Windspeed)
    p1 <- ggplot(data = data3, aes(x = windDirection_N, fill = Windspeed_N))+
        geom_bar( position = position_stack(reverse = TRUE)) + 
        theme_bw() + scale_x_discrete(drop = FALSE,
                                      labels = windD) +
        scale_fill_discrete(guide = guide_legend(reverse=TRUE), name = "Wind Speed (m/s)")+
        coord_polar(start = -0.2) + 
        xlab("") + ggtitle(paste(station_number,"(",start_date,"~",end_date,")"))
    ggsave("P1.png")
    p1
    
    
}
WindData2 <- function(station_number,start_date,end_date){
    url_start <- paste0("https://e-service.cwb.gov.tw/HistoryDataQuery/MonthDataController.do?command=viewMain&station=",station_number,"&stname=%25E5%25A4%25A7%25E5%25AF%25AE&datepicker=")
    start_date <- floor_date(ymd(start_date),unit = "month")  #èµ·å§‹æ™‚é–“
    end_date <- floor_date(ymd(end_date),unit = "month")  #çµ‚æ­¢æ™‚é–“
    int <- interval(start_date, end_date)
    m1 <- time_length(int, "month")
    data1 <- data.frame()
    data2 <- data.frame()
    for(d in c(0:m1)){
        m2 <- start_date + months(d)
        url <- paste0(url_start,as.character(paste0(year(m2),"-",ifelse(month(m2)>=10,
                                                                        month(m2),paste0(0,month(m2))))),"#")
        #æ™‚é–“è³‡æ–™
        time_d <- url %>% 
            read_html() %>%
            html_nodes(xpath='//*[(@id = "MyTable")]//td[(((count(preceding-sibling::*) + 1) = 1) and parent::*)]') %>% 
            html_text(trim	= T) %>% 
            as.numeric()
        #é¢¨é€Ÿè³‡æ–™
        Windspeed <- url %>%
            read_html() %>%
            html_nodes(xpath='//td[(((count(preceding-sibling::*) + 1) = 17) and parent::*)]') %>%
            html_text(trim	= T) %>% 
            gsub("X","-9999", .) %>% 
            as.numeric()
        #é¢¨å‘
        windDirection<- url %>%
            read_html() %>%
            html_nodes(xpath='//td[(((count(preceding-sibling::*) + 1) = 18) and parent::*)]') %>%
            html_text(trim	= T) %>% 
            gsub("X","-9999", .) %>% 
            as.numeric()
        data1 <- cbind(as.character(start_date + months(d)), time_d, Windspeed,windDirection)  #åˆä½µè³‡æ–™
        data2 <- rbind(data2, data1)
    }
    data2
    windD <- factor(c("N","NNE","NE","ENE","E","ESE","SE","SSE","S","SSW","SW","WSW","W","WNW","NW","NNW","N"))
    data3 <- na.omit(data2)  #åˆªé™¤åŒ…å«NAå€¼çš„åˆ—
    data3$windDirection_N <- cut(as.numeric(data3$windDirection),
                                 breaks = c(0, 11.26, 33.76, 56.26, 78.76, 101.26, 127.76, 146.26, 168.76, 191.26, 213.76, 236.26, 258.76, 281.26, 303.76, 326.26, 348.75, 360),
                                 windD,
                                 include.lowest = TRUE)
    data3$Windspeed_N <- cut(as.numeric(data3$Windspeed),
                             breaks =c(0, 2.1, 4.1,  6.1, Inf),
                             labels = c("0~2", "2.1~4", "4.1~6", ">6.1"),
                             right = F)
    data3$Windspeed <- as.numeric(data3$Windspeed)
    p2 <- ggplot(data = data3, aes(x = windDirection_N, fill = Windspeed_N))+
        geom_bar( position = position_stack(reverse = TRUE)) + 
        theme_bw() + scale_x_discrete(drop = FALSE,
                                      labels = windD) +
        scale_fill_discrete(guide = guide_legend(reverse=TRUE), name = "Wind Speed (m/s)")+
        coord_polar(start = -0.2) + 
        xlab("") + ggtitle(paste(station_number,"(",paste0(year(start_date),"-",month(start_date)),
                                 "~",paste0(year(end_date),"-",month(end_date)),")"))
    ggsave("P2.png")
    p2
}


ui <- dashboardPage(
    dashboardHeader(title = "Windrose plot by R",
                    dropdownMenu(type = "messages",
                                 messageItem(
                                     from = "é˜¿å¥½ä¼¯è£½ä½œåˆ†äº«",icon = icon("questiont"),
                                     message = "https://www.facebook.com/LHB0222/",
                                     time = "2021:06:13"
                                 ))),
    dashboardSidebar(
        sidebarMenu(
            menuItem("ç›£æ¸¬ç«™æ­·å²è³‡æ–™", tabName = "dashboard", icon = icon("dashboard")),
            menuItem("æ‰‹å‹•è¼¸å…¥è§’åº¦", icon = icon("glyphicon glyphicon-pencil"), 
                     tabName = "widgets", badgeLabel = "new", badgeColor = "green"),
            menuItem("æ‰‹å‹•è¼¸å…¥æ–¹ä½", icon = icon("glyphicon glyphicon-fullscreen" ,lib = "glyphicon"), 
                     tabName = "widgets2", badgeLabel = "new", badgeColor = "aqua")
        )
    ),
    
    dashboardBody(
        tabItems(
            tabItem(tabName = "dashboard",
                    h2("å…¨è‡ªå‹•æŠ“è³‡æ–™ä¸è²»åŠ›~"),
                    fluidRow(
                        box( title = "Inputs", status = "warning",  #æ›´æ”¹å¤–è§€1
                             solidHeader = TRUE, collapsible = TRUE, #æ›´æ”¹å¤–è§€2
                             textInput ( "station_number" , " ç›£æ¸¬ç«™ç·¨è™Ÿ_é è¨­å¤§å¯®æ¸¬ç«™", value  =  "C0V730" ),
                             helpText("æ¸¬ç«™ç·¨è™ŸæŸ¥è©¢","https://e-service.cwb.gov.tw/HistoryDataQuery/"),
                             radioButtons( "mode", "æ—¥/æœˆè³‡æ–™",choices = c("æ—¥","æœˆ")),
                             dateRangeInput('dateRange',
                                            label = 'Date range input: yyyy-mm-dd',
                                            start = Sys.Date() -1, end = Sys.Date() -1),
                             submitButton(text = "æ›´æ–°", icon = NULL, width = NULL),
                             downloadButton("downloadData", "Download Plot")
                             
                        )),
                    fluidRow(box( title = "Outputs", status = "info",
                                  solidHeader = TRUE, collapsible = TRUE,
                                  plotOutput("WindRosePlote"), width = "600px", height = "400px"))
                    
            ),
            
            tabItem(tabName = "widgets",
                    h2("æ‰‹å‹•è¼¸å…¥å¥½è‡ªç”±~"),#actionButton("done", "Done!"),
                    
                    fluidRow(box( title = "Inputs", status = "warning",
                                  solidHeader = TRUE, collapsible = TRUE,
                                  textInput ( "plottitle2" , " åœ–ç‰‡æ¨™é¡Œ(ä¸­æ–‡å¯èƒ½ä¸æ”¯æ´)", value  =  "Wind Rose" ),
                                  radioButtons( "mode2", "ç›¸å°ç™¾åˆ†æ¯”(%)æˆ–è¨ˆæ•¸(n)",choices = c("%","n")),
                                  helpText("WS = é¢¨é€Ÿï¼› WD = é¢¨å‘è§’åº¦(0~360)"), 
                                  dataEditUI("edit-1")),
                             
                             box(title = "breaks", status = "warning",
                                 solidHeader = TRUE, collapsible = TRUE,
                                 helpText("é¢¨é€Ÿåˆ†ç´š"),
                                 helpText("é è¨­è’²ç¦æ°é¢¨ç´š"),
                                 helpText("æœ€å¾Œä¸€åˆ—ç‚º'Inf'è¡¨ç¤ºç„¡é™å¤§"),
                                 helpText("è‹¥è¦æ–°å¢æˆ–åˆªé™¤è«‹é»é¸å³éµInsert or Remove row"),
                                 #submitButton(text = "æ›´æ–°", icon = NULL, width = NULL),
                                 dataEditUI("edit-3"))),
                    fluidRow(box(title = "Outputs", status = "info", 
                                 solidHeader = TRUE, collapsible = TRUE,
                                 submitButton(text = "æ›´æ–°", icon = NULL, width = NULL),
                                 downloadButton("downloadData2", "Download Plot"),
                                 plotOutput("WindRosePlote2"), width = "600px", height = "400px"))
                    
            ),
            tabItem(tabName = "widgets2",
                    h2("æ‰‹å‹•è¼¸å…¥å¥½è‡ªç”±~"),#actionButton("done", "Done!"),
                    fluidRow(box( title = "Inputs", 
                                  status = "warning",
                                  solidHeader = TRUE, collapsible = TRUE,
                                  #submitButton(text = "æ›´æ–°", icon = NULL, width = NULL),
                                  textInput ( "plottitle3" , " åœ–ç‰‡æ¨™é¡Œ(ä¸­æ–‡å¯èƒ½ä¸æ”¯æ´)", value  =  "Wind Rose" ),
                                  radioButtons( "mode3", "ç›¸å°ç™¾åˆ†æ¯”(%)æˆ–è¨ˆæ•¸(n)",choices = c("%","n")),
                                  #downloadButton("downloadData3", "Download Plot"),
                                  helpText("WS = é¢¨é€Ÿï¼› WD = é¢¨å‘"), 
                                  helpText("æ–¹å‘è«‹è¼¸å…¥N, NNE, NE, ENE, E, ESE, SE, SSE, S, SSW, SW, WSW, W, WNW, NW, NNW"),
                                  dataEditUI("edit-2")),
                             
                             box(title = "breaks", status = "warning",
                                 solidHeader = TRUE, collapsible = TRUE,
                                 helpText("é¢¨é€Ÿåˆ†ç´š"),
                                 helpText("é è¨­è’²ç¦æ°é¢¨ç´š"),
                                 helpText("æœ€å¾Œä¸€åˆ—ç‚º'Inf'è¡¨ç¤ºç„¡é™å¤§è«‹å‹¿åˆªé™¤"),
                                 helpText("è‹¥è¦æ–°å¢æˆ–åˆªé™¤è«‹é»é¸å³éµInsert or Remove row"),
                                 #submitButton(text = "æ›´æ–°", icon = NULL, width = NULL),
                                 dataEditUI("edit-4"))
                    ),
                    fluidRow(box(title = "Outputs3", status = "info", 
                                 solidHeader = TRUE, collapsible = TRUE,
                                 submitButton(text = "æ›´æ–°", icon = NULL, width = NULL),
                                 downloadButton("downloadData3", "Download Plot"),
                                 plotOutput("WindRosePlote3"), width = "600px", height = "400px"))
                    
            )
        )
    )
)

server <- function(input, output,session) {
    #####################
    #å…¨è‡ªå‹•æŠ“è³‡æ–™ä¸è²»åŠ›~#
    #####################
    output$WindRosePlote <- renderPlot(
        if(input$mode == "æ—¥"){
            WindData(input$station_number, input$dateRange[1], input$dateRange[2])
        } else{
            WindData2(input$station_number, input$dateRange[1], input$dateRange[2])
        }
    )
    output$downloadData <- downloadHandler(
        filename = function(){paste0(input$station_number,"(",input$dateRange[1],"_",input$dateRange[2],")",'.png',sep='')},
        content = function(file){
            ggsave(file,plot=if(input$mode == "æ—¥"){
                WindData(input$station_number, input$dateRange[1], input$dateRange[2])
            } else{
                WindData2(input$station_number, input$dateRange[1], input$dateRange[2])
            })
        }
    )
    ##########################
    # æ‰‹å‹•è¼¸å…¥å¥½è‡ªç”±~1 è§’åº¦  #
    ##########################
    data_to_edit <- dataEditServer("edit-1",
                                   data = data.frame(WS = c(1.1:10.1),
                                                     WD = c(seq(from = 1,to = 360,by = 36))))
    data_to_edit_3 <- dataEditServer("edit-3",
                                     data = data.frame(breaks =c(0, 0.3, 1.6, 3.4, 5.5, 8.0,10.8, 13.9, 17.0, 20.8, 24.5, 28.5, 32.7, Inf),
                                                       labels = c("0~0.2","0.3~1.5", "1.6~3.3", "3.4~5.4", "5.5~7.9", "8.0~10.7", "10.8~13.8", "13.9~17.1", "17.2~20.7", "20.8~24.4","24.5~28.4", "28.5~32.6" , ">32.7","Inf")))
    output$WindRosePlote2 <- renderPlot( 
        if (input$mode2 == "%") {
            WRplot3(WRdata = data_to_edit(),
                    input$plottitle2,
                    WSbreaksdata =data_to_edit_3())
        }else{
            WRplot4(WRdata = data_to_edit(),
                    input$plottitle2, 
                    WSbreaksdata =data_to_edit_3())
        }
        
    )
    dataOutputServer("output-1",
                     data = data_to_edit)
    dataOutputServer("output-3",
                     data = data_to_edit_3)
    output$downloadData2 <- downloadHandler( filename = function(){paste(Sys.time(),'.png',sep='')},
                                             content = function(file){  if (input$mode2 == "%"){
                                                 ggsave(file,plot= WRplot3(WRdata = data_to_edit(),
                                                                           input$plottitle2,
                                                                           WSbreaksdata =data_to_edit_3()))
                                             }else{ggsave(file,plot= WRplot4(WRdata = data_to_edit(),
                                                                             input$plottitle2,
                                                                             WSbreaksdata =data_to_edit_3()))}                               
                                                 
                                             }
                                             
    )
    #########################
    #æ‰‹å‹•è¼¸å…¥å¥½è‡ªç”±~2 æ–¹ä½  #
    #########################
    data_to_edit_2 <- dataEditServer("edit-2",
                                     data = data.frame(WS = c(1.1:10.1),
                                                       WD = c(rep("E", times = 1, length.out = 10))))
    data_to_edit_4 <- dataEditServer("edit-4",
                                     data = data.frame(breaks =c(0, 0.3, 1.6, 3.4, 5.5, 8.0,10.8, 13.9, 17.2, 20.8, 24.5, 28.5, 32.7, Inf),
                                                       labels = c("0~0.2","0.3~1.5", "1.6~3.3", "3.4~5.4", "5.5~7.9", "8.0~10.7", "10.8~13.8", "13.9~17.1", "17.2~20.7", "20.8~24.4","24.5~28.4", "28.5~32.6" , ">32.7","Inf")))
    dataOutputServer("output-4",
                     data = data_to_edit_4)
    output$WindRosePlote3 <- renderPlot( 
        if (input$mode3 == "%") {WRplot(WRdata = data_to_edit_2(),input$plottitle3,
                                        WSbreaksdata =data_to_edit_4())
        }else{
            WRplot2(WRdata = data_to_edit_2(),input$plottitle3,
                    WSbreaksdata =data_to_edit_4())
        }
    )
    dataOutputServer("output-2",
                     data = data_to_edit_2)
    output$downloadData3 <- downloadHandler( filename = function(){paste(Sys.time(),'.png',sep='')},
                                             content = function(file){  if (input$mode2 == "%"){
                                                 ggsave(file,plot= WRplot(WRdata = data_to_edit_2(),
                                                                          input$plottitle3,
                                                                          WSbreaksdata =data_to_edit_4()))
                                             }else{ggsave(file,plot= WRplot2(WRdata = data_to_edit_2(),
                                                                             input$plottitle3,
                                                                             WSbreaksdata =data_to_edit_4()))}                               
                                                 
                                             }
                                             
    )
}

shinyApp(ui, server)
```



# shinydashboard ç¶²å€
https://gtgrthrst.shinyapps.io/Wind_Rose_pro/

>åƒè€ƒè³‡æ–™
>https://rstudio.github.io/shinydashboard/
>https://yjtseng.info/shinybook/dashboard

ğŸŒŸå…¨æ–‡å¯ä»¥è‡³ä¸‹æ–¹é€£çµè§€çœ‹æˆ–æ˜¯è£œå……
https://hackmd.io/@LHB-0222/shinydashboard

å…¨æ–‡åˆ†äº«è‡³

https://www.facebook.com/LHB0222/

https://www.instagram.com/ahb0222/

æœ‰ç–‘å•æƒ³è¨è«–çš„éƒ½æ­¡è¿æ–¼ä¸‹æ–¹ç•™è¨€

å–œæ­¡çš„å¹«æˆ‘åˆ†äº«çµ¦æ‰€æœ‰çš„æœ‹å‹ \o/

æœ‰æ‰€éŒ¯èª¤æ­¡è¿æŒ‡æ•™

# [:page_with_curl: å…¨éƒ¨æ–‡ç« åˆ—è¡¨](https://hackmd.io/@LHB-0222/AllWritings)


![](https://i.imgur.com/47HlvGH.png)

